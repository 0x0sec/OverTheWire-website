<a name="line1" href="#line1"> 1</a> <font color="0000ff"><strong>#include <font color="#008000">&lt;sys/types.h&gt;</font></strong></font>
<a name="line2" href="#line2"> 2</a> <font color="0000ff"><strong>#include <font color="#008000">&lt;sys/stat.h&gt;</font></strong></font>
<a name="line3" href="#line3"> 3</a> <font color="0000ff"><strong>#include <font color="#008000">&lt;stdio.h&gt;</font></strong></font>
<a name="line4" href="#line4"> 4</a> <font color="0000ff"><strong>#include <font color="#008000">&lt;stdlib.h&gt;</font></strong></font>
<a name="line5" href="#line5"> 5</a> <font color="0000ff"><strong>#include <font color="#008000">&lt;fcntl.h&gt;</font></strong></font>
<a name="line6" href="#line6"> 6</a> <font color="0000ff"><strong>#include <font color="#008000">&lt;errno.h&gt;</font></strong></font>
<a name="line7" href="#line7"> 7</a> <font color="0000ff"><strong>#define _GNU_SOURCE</strong></font>
<a name="line8" href="#line8"> 8</a> <font color="0000ff"><strong>#include <font color="#008000">&lt;unistd.h&gt;</font></strong></font>
<a name="line9" href="#line9"> 9</a> 
<a name="line10" href="#line10">10</a> 
<a name="line11" href="#line11">11</a> <font color="0000ff"><strong>#define TARGET_UID 1998</strong></font>
<a name="line12" href="#line12">12</a> 
<a name="line13" href="#line13">13</a> <strong>int</strong> <font color="#2040a0">daemonize</font><font color="4444FF">(</font><font color="4444FF">)</font>
<a name="line14" href="#line14">14</a> <font color="4444FF"><strong>{</strong></font>
<a name="line15" href="#line15">15</a>         <strong>int</strong> <font color="#2040a0">ret</font> <font color="4444FF">=</font> <font color="4444FF">-</font><font color="#FF0000">1</font><font color="4444FF">;</font>
<a name="line16" href="#line16">16</a> 
<a name="line17" href="#line17">17</a>         <strong>if</strong><font color="4444FF">(</font><font color="4444FF">(</font><font color="#2040a0">daemon</font><font color="4444FF">(</font><font color="#FF0000">0</font>, <font color="#FF0000">0</font><font color="4444FF">)</font><font color="4444FF">)</font> <font color="4444FF">=</font><font color="4444FF">=</font> <font color="4444FF">-</font><font color="#FF0000">1</font><font color="4444FF">)</font>
<a name="line18" href="#line18">18</a>                 <strong>return</strong> <font color="#2040a0">ret</font><font color="4444FF">;</font>
<a name="line19" href="#line19">19</a> 
<a name="line20" href="#line20">20</a>         <strong>if</strong><font color="4444FF">(</font><font color="4444FF">(</font><font color="#2040a0">setresgid</font><font color="4444FF">(</font><font color="#2040a0">TARGET_UID</font>, <font color="#2040a0">TARGET_UID</font>, <font color="#2040a0">TARGET_UID</font><font color="4444FF">)</font><font color="4444FF">)</font> <font color="4444FF">=</font><font color="4444FF">=</font> <font color="4444FF">-</font><font color="#FF0000">1</font><font color="4444FF">)</font>
<a name="line21" href="#line21">21</a>                 <strong>return</strong> <font color="#2040a0">ret</font><font color="4444FF">;</font>
<a name="line22" href="#line22">22</a>         <strong>if</strong><font color="4444FF">(</font><font color="4444FF">(</font><font color="#2040a0">setresuid</font><font color="4444FF">(</font><font color="#2040a0">TARGET_UID</font>, <font color="#2040a0">TARGET_UID</font>, <font color="#2040a0">TARGET_UID</font><font color="4444FF">)</font><font color="4444FF">)</font> <font color="4444FF">=</font><font color="4444FF">=</font> <font color="4444FF">-</font><font color="#FF0000">1</font><font color="4444FF">)</font>
<a name="line23" href="#line23">23</a>                 <strong>return</strong> <font color="#2040a0">ret</font><font color="4444FF">;</font>
<a name="line24" href="#line24">24</a> 
<a name="line25" href="#line25">25</a>         <font color="#2040a0">ret</font> <font color="4444FF">=</font> <font color="#FF0000">0</font><font color="4444FF">;</font>
<a name="line26" href="#line26">26</a> 
<a name="line27" href="#line27">27</a>         <strong>return</strong> <font color="#2040a0">ret</font><font color="4444FF">;</font>
<a name="line28" href="#line28">28</a>         
<a name="line29" href="#line29">29</a> <font color="4444FF"><strong>}</strong></font>
