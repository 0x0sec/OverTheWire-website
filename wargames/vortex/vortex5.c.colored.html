<a name="line1" href="#line1">  1</a> <font color="#444444">/* A tribute to arc :) */</font>
<a name="line2" href="#line2">  2</a> 
<a name="line3" href="#line3">  3</a> 
<a name="line4" href="#line4">  4</a> <font color="#444444">/*
<a name="line5" href="#line5">  5</a> ** SQLite uses this code for testing only.  It is not a part of
<a name="line6" href="#line6">  6</a> ** the SQLite library.  This file implements two new TCL commands
<a name="line7" href="#line7">  7</a> ** &quot;md5&quot; and &quot;md5file&quot; that compute md5 checksums on arbitrary text
<a name="line8" href="#line8">  8</a> ** and on complete files.  These commands are used by the &quot;testfixture&quot;
<a name="line9" href="#line9">  9</a> ** program to help verify the correct operation of the SQLite library.
<a name="line10" href="#line10"> 10</a> **
<a name="line11" href="#line11"> 11</a> ** The original use of these TCL commands was to test the ROLLBACK
<a name="line12" href="#line12"> 12</a> ** feature of SQLite.  First compute the MD5-checksum of the database.
<a name="line13" href="#line13"> 13</a> ** Then make some changes but rollback the changes rather than commit
<a name="line14" href="#line14"> 14</a> ** them.  Compute a second MD5-checksum of the file and verify that the
<a name="line15" href="#line15"> 15</a> ** two checksums are the same.  Such is the original use of this code.
<a name="line16" href="#line16"> 16</a> ** New uses may have been added since this comment was written.
<a name="line17" href="#line17"> 17</a> */</font>
<a name="line18" href="#line18"> 18</a> <font color="#444444">/*
<a name="line19" href="#line19"> 19</a>  * This code implements the MD5 message-digest algorithm.
<a name="line20" href="#line20"> 20</a>  * The algorithm is due to Ron Rivest.  This code was
<a name="line21" href="#line21"> 21</a>  * written by Colin Plumb in 1993, no copyright is claimed.
<a name="line22" href="#line22"> 22</a>  * This code is in the public domain; do with it what you wish.
<a name="line23" href="#line23"> 23</a>  *
<a name="line24" href="#line24"> 24</a>  * Equivalent code is available from RSA Data Security, Inc.
<a name="line25" href="#line25"> 25</a>  * This code has been tested against that, and is equivalent,
<a name="line26" href="#line26"> 26</a>  * except that you don't need to include two pages of legalese
<a name="line27" href="#line27"> 27</a>  * with every copy.
<a name="line28" href="#line28"> 28</a>  *
<a name="line29" href="#line29"> 29</a>  * To compute the message digest of a chunk of bytes, declare an
<a name="line30" href="#line30"> 30</a>  * MD5Context structure, pass it to MD5Init, call MD5Update as
<a name="line31" href="#line31"> 31</a>  * needed on buffers full of bytes, and then call MD5Final, which
<a name="line32" href="#line32"> 32</a>  * will fill a supplied 16-byte array with the digest.
<a name="line33" href="#line33"> 33</a>  */</font>
<a name="line34" href="#line34"> 34</a> 
<a name="line35" href="#line35"> 35</a> <font color="#444444">/*
<a name="line36" href="#line36"> 36</a>  * If compiled on a machine that doesn't have a 32-bit integer,
<a name="line37" href="#line37"> 37</a>  * you just set &quot;uint32&quot; to the appropriate datatype for an
<a name="line38" href="#line38"> 38</a>  * unsigned 32-bit integer.  For example:
<a name="line39" href="#line39"> 39</a>  *
<a name="line40" href="#line40"> 40</a>  *       cc -Duint32='unsigned long' md5.c
<a name="line41" href="#line41"> 41</a>  *
<a name="line42" href="#line42"> 42</a>  */</font>
<a name="line43" href="#line43"> 43</a> <font color="0000ff"><strong>#ifndef uint32</strong></font>
<a name="line44" href="#line44"> 44</a> <font color="0000ff"><strong>#  define uint32 unsigned int</strong></font>
<a name="line45" href="#line45"> 45</a> <font color="0000ff"><strong>#endif</strong></font>
<a name="line46" href="#line46"> 46</a> 
<a name="line47" href="#line47"> 47</a> <strong>struct</strong> <font color="#2040a0">Context</font> <font color="4444FF"><strong>{</strong></font>
<a name="line48" href="#line48"> 48</a>   <font color="#2040a0">uint32</font> <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">4</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line49" href="#line49"> 49</a>   <font color="#2040a0">uint32</font> <font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">2</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line50" href="#line50"> 50</a>   <strong>unsigned</strong> <strong>char</strong> <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">64</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line51" href="#line51"> 51</a> <font color="4444FF"><strong>}</strong></font><font color="4444FF">;</font>
<a name="line52" href="#line52"> 52</a> <strong>typedef</strong> <strong>char</strong> <font color="#2040a0">MD5Context</font><font color="4444FF">[</font><font color="#FF0000">88</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line53" href="#line53"> 53</a> 
<a name="line54" href="#line54"> 54</a> <font color="#444444">/*
<a name="line55" href="#line55"> 55</a>  * Note: this code is harmless on little-endian machines.
<a name="line56" href="#line56"> 56</a>  */</font>
<a name="line57" href="#line57"> 57</a> <strong>static</strong> <strong>void</strong> <font color="#2040a0">byteReverse</font> <font color="4444FF">(</font><strong>unsigned</strong> <strong>char</strong> <font color="4444FF">*</font><font color="#2040a0">buf</font>, <strong>unsigned</strong> <font color="#2040a0">longs</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
<a name="line58" href="#line58"> 58</a>         <font color="#2040a0">uint32</font> <font color="#2040a0">t</font><font color="4444FF">;</font>
<a name="line59" href="#line59"> 59</a>         <strong>do</strong> <font color="4444FF"><strong>{</strong></font>
<a name="line60" href="#line60"> 60</a>                 <font color="#2040a0">t</font> <font color="4444FF">=</font> <font color="4444FF">(</font><font color="#2040a0">uint32</font><font color="4444FF">)</font><font color="4444FF">(</font><font color="4444FF">(</font><strong>unsigned</strong><font color="4444FF">)</font><font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">3</font><font color="4444FF">]</font><font color="4444FF">&lt;</font><font color="4444FF">&lt;</font><font color="#FF0000">8</font> <font color="4444FF">|</font> <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">2</font><font color="4444FF">]</font><font color="4444FF">)</font> <font color="4444FF">&lt;</font><font color="4444FF">&lt;</font> <font color="#FF0000">16</font> <font color="4444FF">|</font>
<a name="line61" href="#line61"> 61</a>                             <font color="4444FF">(</font><font color="4444FF">(</font><strong>unsigned</strong><font color="4444FF">)</font><font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">&lt;</font><font color="4444FF">&lt;</font><font color="#FF0000">8</font> <font color="4444FF">|</font> <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line62" href="#line62"> 62</a>                 <font color="4444FF">*</font><font color="4444FF">(</font><font color="#2040a0">uint32</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">buf</font> <font color="4444FF">=</font> <font color="#2040a0">t</font><font color="4444FF">;</font>
<a name="line63" href="#line63"> 63</a>                 <font color="#2040a0">buf</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#FF0000">4</font><font color="4444FF">;</font>
<a name="line64" href="#line64"> 64</a>         <font color="4444FF"><strong>}</strong></font> <strong>while</strong> <font color="4444FF">(</font><font color="4444FF">-</font><font color="4444FF">-</font><font color="#2040a0">longs</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line65" href="#line65"> 65</a> <font color="4444FF"><strong>}</strong></font>
<a name="line66" href="#line66"> 66</a> <font color="#444444">/* The four core functions - F1 is optimized somewhat */</font>
<a name="line67" href="#line67"> 67</a> 
<a name="line68" href="#line68"> 68</a> <font color="#444444">/* #define F1(x, y, z) (x &amp; y | ~x &amp; z) */</font>
<a name="line69" href="#line69"> 69</a> <font color="0000ff"><strong>#define F1(x, y, z) (z ^ (x &amp; (y ^ z)))</strong></font>
<a name="line70" href="#line70"> 70</a> <font color="0000ff"><strong>#define F2(x, y, z) F1(z, x, y)</strong></font>
<a name="line71" href="#line71"> 71</a> <font color="0000ff"><strong>#define F3(x, y, z) (x ^ y ^ z)</strong></font>
<a name="line72" href="#line72"> 72</a> <font color="0000ff"><strong>#define F4(x, y, z) (y ^ (x | ~z))</strong></font>
<a name="line73" href="#line73"> 73</a> 
<a name="line74" href="#line74"> 74</a> <font color="#444444">/* This is the central step in the MD5 algorithm. */</font>
<a name="line75" href="#line75"> 75</a> <font color="0000ff"><strong>#define MD5STEP(f, w, x, y, z, data, s) \</strong></font>
<a name="line76" href="#line76"> 76</a>         <font color="4444FF">(</font> <font color="#2040a0">w</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#2040a0">f</font><font color="4444FF">(</font><font color="#2040a0">x</font>, <font color="#2040a0">y</font>, <font color="#2040a0">z</font><font color="4444FF">)</font> <font color="4444FF">+</font> <font color="#2040a0">data</font>,  <font color="#2040a0">w</font> <font color="4444FF">=</font> <font color="#2040a0">w</font><font color="4444FF">&lt;</font><font color="4444FF">&lt;</font><font color="#2040a0">s</font> <font color="4444FF">|</font> <font color="#2040a0">w</font><font color="4444FF">&gt;</font><font color="4444FF">&gt;</font><font color="4444FF">(</font><font color="#FF0000">32</font><font color="4444FF">-</font><font color="#2040a0">s</font><font color="4444FF">)</font>,  <font color="#2040a0">w</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#2040a0">x</font> <font color="4444FF">)</font>
<a name="line77" href="#line77"> 77</a> 
<a name="line78" href="#line78"> 78</a> <font color="#444444">/*
<a name="line79" href="#line79"> 79</a>  * The core of the MD5 algorithm, this alters an existing MD5 hash to
<a name="line80" href="#line80"> 80</a>  * reflect the addition of 16 longwords of new data.  MD5Update blocks
<a name="line81" href="#line81"> 81</a>  * the data and converts bytes into longwords for this routine.
<a name="line82" href="#line82"> 82</a>  */</font>
<a name="line83" href="#line83"> 83</a> <strong>static</strong> <strong>void</strong> <font color="#2040a0">MD5Transform</font><font color="4444FF">(</font><font color="#2040a0">uint32</font> <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">4</font><font color="4444FF">]</font>, <strong>const</strong> <font color="#2040a0">uint32</font> <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">16</font><font color="4444FF">]</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
<a name="line84" href="#line84"> 84</a>         <strong>register</strong> <font color="#2040a0">uint32</font> <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font><font color="4444FF">;</font>
<a name="line85" href="#line85"> 85</a> 
<a name="line86" href="#line86"> 86</a>         <font color="#2040a0">a</font> <font color="4444FF">=</font> <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line87" href="#line87"> 87</a>         <font color="#2040a0">b</font> <font color="4444FF">=</font> <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line88" href="#line88"> 88</a>         <font color="#2040a0">c</font> <font color="4444FF">=</font> <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">2</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line89" href="#line89"> 89</a>         <font color="#2040a0">d</font> <font color="4444FF">=</font> <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">3</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line90" href="#line90"> 90</a> 
<a name="line91" href="#line91"> 91</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">0</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xd76aa478</font>,  <font color="#FF0000">7</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line92" href="#line92"> 92</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xe8c7b756</font>, <font color="#FF0000">12</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line93" href="#line93"> 93</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">2</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x242070db</font>, <font color="#FF0000">17</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line94" href="#line94"> 94</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">3</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xc1bdceee</font>, <font color="#FF0000">22</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line95" href="#line95"> 95</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">4</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xf57c0faf</font>,  <font color="#FF0000">7</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line96" href="#line96"> 96</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">5</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x4787c62a</font>, <font color="#FF0000">12</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line97" href="#line97"> 97</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">6</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xa8304613</font>, <font color="#FF0000">17</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line98" href="#line98"> 98</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">7</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xfd469501</font>, <font color="#FF0000">22</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line99" href="#line99"> 99</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">8</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x698098d8</font>,  <font color="#FF0000">7</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line100" href="#line100">100</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">9</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x8b44f7af</font>, <font color="#FF0000">12</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line101" href="#line101">101</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">10</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xffff5bb1</font>, <font color="#FF0000">17</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line102" href="#line102">102</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">11</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x895cd7be</font>, <font color="#FF0000">22</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line103" href="#line103">103</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">12</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x6b901122</font>,  <font color="#FF0000">7</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line104" href="#line104">104</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">13</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xfd987193</font>, <font color="#FF0000">12</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line105" href="#line105">105</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">14</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xa679438e</font>, <font color="#FF0000">17</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line106" href="#line106">106</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F1</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">15</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x49b40821</font>, <font color="#FF0000">22</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line107" href="#line107">107</a> 
<a name="line108" href="#line108">108</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xf61e2562</font>,  <font color="#FF0000">5</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line109" href="#line109">109</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">6</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xc040b340</font>,  <font color="#FF0000">9</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line110" href="#line110">110</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">11</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x265e5a51</font>, <font color="#FF0000">14</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line111" href="#line111">111</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">0</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xe9b6c7aa</font>, <font color="#FF0000">20</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line112" href="#line112">112</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">5</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xd62f105d</font>,  <font color="#FF0000">5</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line113" href="#line113">113</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">10</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x02441453</font>,  <font color="#FF0000">9</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line114" href="#line114">114</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">15</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xd8a1e681</font>, <font color="#FF0000">14</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line115" href="#line115">115</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">4</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xe7d3fbc8</font>, <font color="#FF0000">20</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line116" href="#line116">116</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">9</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x21e1cde6</font>,  <font color="#FF0000">5</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line117" href="#line117">117</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">14</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xc33707d6</font>,  <font color="#FF0000">9</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line118" href="#line118">118</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">3</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xf4d50d87</font>, <font color="#FF0000">14</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line119" href="#line119">119</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">8</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x455a14ed</font>, <font color="#FF0000">20</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line120" href="#line120">120</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">13</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xa9e3e905</font>,  <font color="#FF0000">5</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line121" href="#line121">121</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">2</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xfcefa3f8</font>,  <font color="#FF0000">9</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line122" href="#line122">122</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">7</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x676f02d9</font>, <font color="#FF0000">14</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line123" href="#line123">123</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F2</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">12</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x8d2a4c8a</font>, <font color="#FF0000">20</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line124" href="#line124">124</a> 
<a name="line125" href="#line125">125</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">5</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xfffa3942</font>,  <font color="#FF0000">4</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line126" href="#line126">126</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">8</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x8771f681</font>, <font color="#FF0000">11</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line127" href="#line127">127</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">11</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x6d9d6122</font>, <font color="#FF0000">16</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line128" href="#line128">128</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">14</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xfde5380c</font>, <font color="#FF0000">23</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line129" href="#line129">129</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xa4beea44</font>,  <font color="#FF0000">4</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line130" href="#line130">130</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">4</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x4bdecfa9</font>, <font color="#FF0000">11</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line131" href="#line131">131</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">7</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xf6bb4b60</font>, <font color="#FF0000">16</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line132" href="#line132">132</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">10</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xbebfbc70</font>, <font color="#FF0000">23</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line133" href="#line133">133</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">13</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x289b7ec6</font>,  <font color="#FF0000">4</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line134" href="#line134">134</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">0</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xeaa127fa</font>, <font color="#FF0000">11</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line135" href="#line135">135</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">3</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xd4ef3085</font>, <font color="#FF0000">16</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line136" href="#line136">136</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">6</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x04881d05</font>, <font color="#FF0000">23</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line137" href="#line137">137</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">9</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xd9d4d039</font>,  <font color="#FF0000">4</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line138" href="#line138">138</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">12</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xe6db99e5</font>, <font color="#FF0000">11</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line139" href="#line139">139</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">15</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x1fa27cf8</font>, <font color="#FF0000">16</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line140" href="#line140">140</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F3</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">2</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xc4ac5665</font>, <font color="#FF0000">23</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line141" href="#line141">141</a> 
<a name="line142" href="#line142">142</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">0</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xf4292244</font>,  <font color="#FF0000">6</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line143" href="#line143">143</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">7</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x432aff97</font>, <font color="#FF0000">10</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line144" href="#line144">144</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">14</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xab9423a7</font>, <font color="#FF0000">15</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line145" href="#line145">145</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">5</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xfc93a039</font>, <font color="#FF0000">21</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line146" href="#line146">146</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">12</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x655b59c3</font>,  <font color="#FF0000">6</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line147" href="#line147">147</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">3</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x8f0ccc92</font>, <font color="#FF0000">10</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line148" href="#line148">148</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">10</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xffeff47d</font>, <font color="#FF0000">15</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line149" href="#line149">149</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x85845dd1</font>, <font color="#FF0000">21</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line150" href="#line150">150</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">8</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x6fa87e4f</font>,  <font color="#FF0000">6</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line151" href="#line151">151</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">15</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xfe2ce6e0</font>, <font color="#FF0000">10</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line152" href="#line152">152</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">6</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xa3014314</font>, <font color="#FF0000">15</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line153" href="#line153">153</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">13</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x4e0811a1</font>, <font color="#FF0000">21</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line154" href="#line154">154</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">4</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xf7537e82</font>,  <font color="#FF0000">6</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line155" href="#line155">155</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">in</font><font color="4444FF">[</font><font color="#FF0000">11</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xbd3af235</font>, <font color="#FF0000">10</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line156" href="#line156">156</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">b</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">2</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0x2ad7d2bb</font>, <font color="#FF0000">15</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line157" href="#line157">157</a>         <font color="#2040a0">MD5STEP</font><font color="4444FF">(</font><font color="#2040a0">F4</font>, <font color="#2040a0">b</font>, <font color="#2040a0">c</font>, <font color="#2040a0">d</font>, <font color="#2040a0">a</font>, <font color="#2040a0">in</font><font color="4444FF">[</font> <font color="#FF0000">9</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="#FF0000">0xeb86d391</font>, <font color="#FF0000">21</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line158" href="#line158">158</a> 
<a name="line159" href="#line159">159</a>         <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#2040a0">a</font><font color="4444FF">;</font>
<a name="line160" href="#line160">160</a>         <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#2040a0">b</font><font color="4444FF">;</font>
<a name="line161" href="#line161">161</a>         <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">2</font><font color="4444FF">]</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#2040a0">c</font><font color="4444FF">;</font>
<a name="line162" href="#line162">162</a>         <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">3</font><font color="4444FF">]</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#2040a0">d</font><font color="4444FF">;</font>
<a name="line163" href="#line163">163</a> <font color="4444FF"><strong>}</strong></font>
<a name="line164" href="#line164">164</a> 
<a name="line165" href="#line165">165</a> <font color="#444444">/*
<a name="line166" href="#line166">166</a>  * Start MD5 accumulation.  Set bit count to 0 and buffer to mysterious
<a name="line167" href="#line167">167</a>  * initialization constants.
<a name="line168" href="#line168">168</a>  */</font>
<a name="line169" href="#line169">169</a> <strong>static</strong> <strong>void</strong> <font color="#2040a0">MD5Init</font><font color="4444FF">(</font><font color="#2040a0">MD5Context</font> <font color="4444FF">*</font><font color="#2040a0">pCtx</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
<a name="line170" href="#line170">170</a>         <strong>struct</strong> <font color="#2040a0">Context</font> <font color="4444FF">*</font><font color="#2040a0">ctx</font> <font color="4444FF">=</font> <font color="4444FF">(</font><strong>struct</strong> <font color="#2040a0">Context</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">pCtx</font><font color="4444FF">;</font>
<a name="line171" href="#line171">171</a>         <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#FF0000">0x67452301</font><font color="4444FF">;</font>
<a name="line172" href="#line172">172</a>         <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#FF0000">0xefcdab89</font><font color="4444FF">;</font>
<a name="line173" href="#line173">173</a>         <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">2</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#FF0000">0x98badcfe</font><font color="4444FF">;</font>
<a name="line174" href="#line174">174</a>         <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">3</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#FF0000">0x10325476</font><font color="4444FF">;</font>
<a name="line175" href="#line175">175</a>         <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#FF0000">0</font><font color="4444FF">;</font>
<a name="line176" href="#line176">176</a>         <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#FF0000">0</font><font color="4444FF">;</font>
<a name="line177" href="#line177">177</a> <font color="4444FF"><strong>}</strong></font>
<a name="line178" href="#line178">178</a> 
<a name="line179" href="#line179">179</a> <font color="#444444">/*
<a name="line180" href="#line180">180</a>  * Update context to reflect the concatenation of another buffer full
<a name="line181" href="#line181">181</a>  * of bytes.
<a name="line182" href="#line182">182</a>  */</font>
<a name="line183" href="#line183">183</a> <strong>static</strong> 
<a name="line184" href="#line184">184</a> <strong>void</strong> <font color="#2040a0">MD5Update</font><font color="4444FF">(</font><font color="#2040a0">MD5Context</font> <font color="4444FF">*</font><font color="#2040a0">pCtx</font>, <strong>const</strong> <strong>unsigned</strong> <strong>char</strong> <font color="4444FF">*</font><font color="#2040a0">buf</font>, <strong>unsigned</strong> <strong>int</strong> <font color="#2040a0">len</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
<a name="line185" href="#line185">185</a>         <strong>struct</strong> <font color="#2040a0">Context</font> <font color="4444FF">*</font><font color="#2040a0">ctx</font> <font color="4444FF">=</font> <font color="4444FF">(</font><strong>struct</strong> <font color="#2040a0">Context</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">pCtx</font><font color="4444FF">;</font>
<a name="line186" href="#line186">186</a>         <font color="#2040a0">uint32</font> <font color="#2040a0">t</font><font color="4444FF">;</font>
<a name="line187" href="#line187">187</a> 
<a name="line188" href="#line188">188</a>         <font color="#444444">/* Update bitcount */</font>
<a name="line189" href="#line189">189</a> 
<a name="line190" href="#line190">190</a>         <font color="#2040a0">t</font> <font color="4444FF">=</font> <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line191" href="#line191">191</a>         <strong>if</strong> <font color="4444FF">(</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#2040a0">t</font> <font color="4444FF">+</font> <font color="4444FF">(</font><font color="4444FF">(</font><font color="#2040a0">uint32</font><font color="4444FF">)</font><font color="#2040a0">len</font> <font color="4444FF">&lt;</font><font color="4444FF">&lt;</font> <font color="#FF0000">3</font><font color="4444FF">)</font><font color="4444FF">)</font> <font color="4444FF">&lt;</font> <font color="#2040a0">t</font><font color="4444FF">)</font>
<a name="line192" href="#line192">192</a>                 <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">+</font><font color="4444FF">+</font><font color="4444FF">;</font> <font color="#444444">/* Carry from low to high */</font>
<a name="line193" href="#line193">193</a>         <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#2040a0">len</font> <font color="4444FF">&gt;</font><font color="4444FF">&gt;</font> <font color="#FF0000">29</font><font color="4444FF">;</font>
<a name="line194" href="#line194">194</a> 
<a name="line195" href="#line195">195</a>         <font color="#2040a0">t</font> <font color="4444FF">=</font> <font color="4444FF">(</font><font color="#2040a0">t</font> <font color="4444FF">&gt;</font><font color="4444FF">&gt;</font> <font color="#FF0000">3</font><font color="4444FF">)</font> <font color="4444FF">&amp;</font> <font color="#FF0000">0x3f</font><font color="4444FF">;</font>    <font color="#444444">/* Bytes already in shsInfo-&gt;data */</font>
<a name="line196" href="#line196">196</a> 
<a name="line197" href="#line197">197</a>         <font color="#444444">/* Handle any leading odd-sized chunks */</font>
<a name="line198" href="#line198">198</a> 
<a name="line199" href="#line199">199</a>         <strong>if</strong> <font color="4444FF">(</font> <font color="#2040a0">t</font> <font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>
<a name="line200" href="#line200">200</a>                 <strong>unsigned</strong> <strong>char</strong> <font color="4444FF">*</font><font color="#2040a0">p</font> <font color="4444FF">=</font> <font color="4444FF">(</font><strong>unsigned</strong> <strong>char</strong> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font> <font color="4444FF">+</font> <font color="#2040a0">t</font><font color="4444FF">;</font>
<a name="line201" href="#line201">201</a> 
<a name="line202" href="#line202">202</a>                 <font color="#2040a0">t</font> <font color="4444FF">=</font> <font color="#FF0000">64</font><font color="4444FF">-</font><font color="#2040a0">t</font><font color="4444FF">;</font>
<a name="line203" href="#line203">203</a>                 <strong>if</strong> <font color="4444FF">(</font><font color="#2040a0">len</font> <font color="4444FF">&lt;</font> <font color="#2040a0">t</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>
<a name="line204" href="#line204">204</a>                         <font color="#2040a0">memcpy</font><font color="4444FF">(</font><font color="#2040a0">p</font>, <font color="#2040a0">buf</font>, <font color="#2040a0">len</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line205" href="#line205">205</a>                         <strong>return</strong><font color="4444FF">;</font>
<a name="line206" href="#line206">206</a>                 <font color="4444FF"><strong>}</strong></font>
<a name="line207" href="#line207">207</a>                 <font color="#2040a0">memcpy</font><font color="4444FF">(</font><font color="#2040a0">p</font>, <font color="#2040a0">buf</font>, <font color="#2040a0">t</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line208" href="#line208">208</a>                 <font color="#2040a0">byteReverse</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font>, <font color="#FF0000">16</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line209" href="#line209">209</a>                 <font color="#2040a0">MD5Transform</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font>, <font color="4444FF">(</font><font color="#2040a0">uint32</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line210" href="#line210">210</a>                 <font color="#2040a0">buf</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#2040a0">t</font><font color="4444FF">;</font>
<a name="line211" href="#line211">211</a>                 <font color="#2040a0">len</font> <font color="4444FF">-</font><font color="4444FF">=</font> <font color="#2040a0">t</font><font color="4444FF">;</font>
<a name="line212" href="#line212">212</a>         <font color="4444FF"><strong>}</strong></font>
<a name="line213" href="#line213">213</a> 
<a name="line214" href="#line214">214</a>         <font color="#444444">/* Process data in 64-byte chunks */</font>
<a name="line215" href="#line215">215</a> 
<a name="line216" href="#line216">216</a>         <strong>while</strong> <font color="4444FF">(</font><font color="#2040a0">len</font> <font color="4444FF">&gt;</font><font color="4444FF">=</font> <font color="#FF0000">64</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>
<a name="line217" href="#line217">217</a>                 <font color="#2040a0">memcpy</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font>, <font color="#2040a0">buf</font>, <font color="#FF0000">64</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line218" href="#line218">218</a>                 <font color="#2040a0">byteReverse</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font>, <font color="#FF0000">16</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line219" href="#line219">219</a>                 <font color="#2040a0">MD5Transform</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font>, <font color="4444FF">(</font><font color="#2040a0">uint32</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line220" href="#line220">220</a>                 <font color="#2040a0">buf</font> <font color="4444FF">+</font><font color="4444FF">=</font> <font color="#FF0000">64</font><font color="4444FF">;</font>
<a name="line221" href="#line221">221</a>                 <font color="#2040a0">len</font> <font color="4444FF">-</font><font color="4444FF">=</font> <font color="#FF0000">64</font><font color="4444FF">;</font>
<a name="line222" href="#line222">222</a>         <font color="4444FF"><strong>}</strong></font>
<a name="line223" href="#line223">223</a> 
<a name="line224" href="#line224">224</a>         <font color="#444444">/* Handle any remaining bytes of data. */</font>
<a name="line225" href="#line225">225</a> 
<a name="line226" href="#line226">226</a>         <font color="#2040a0">memcpy</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font>, <font color="#2040a0">buf</font>, <font color="#2040a0">len</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line227" href="#line227">227</a> <font color="4444FF"><strong>}</strong></font>
<a name="line228" href="#line228">228</a> 
<a name="line229" href="#line229">229</a> <font color="#444444">/*
<a name="line230" href="#line230">230</a>  * Final wrapup - pad to 64-byte boundary with the bit pattern 
<a name="line231" href="#line231">231</a>  * 1 0* (64-bit count of bits processed, MSB-first)
<a name="line232" href="#line232">232</a>  */</font>
<a name="line233" href="#line233">233</a> <strong>static</strong> <strong>void</strong> <font color="#2040a0">MD5Final</font><font color="4444FF">(</font><strong>unsigned</strong> <strong>char</strong> <font color="#2040a0">digest</font><font color="4444FF">[</font><font color="#FF0000">16</font><font color="4444FF">]</font>, <font color="#2040a0">MD5Context</font> <font color="4444FF">*</font><font color="#2040a0">pCtx</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
<a name="line234" href="#line234">234</a>         <strong>struct</strong> <font color="#2040a0">Context</font> <font color="4444FF">*</font><font color="#2040a0">ctx</font> <font color="4444FF">=</font> <font color="4444FF">(</font><strong>struct</strong> <font color="#2040a0">Context</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">pCtx</font><font color="4444FF">;</font>
<a name="line235" href="#line235">235</a>         <strong>unsigned</strong> <font color="#2040a0">count</font><font color="4444FF">;</font>
<a name="line236" href="#line236">236</a>         <strong>unsigned</strong> <strong>char</strong> <font color="4444FF">*</font><font color="#2040a0">p</font><font color="4444FF">;</font>
<a name="line237" href="#line237">237</a> 
<a name="line238" href="#line238">238</a>         <font color="#444444">/* Compute number of bytes mod 64 */</font>
<a name="line239" href="#line239">239</a>         <font color="#2040a0">count</font> <font color="4444FF">=</font> <font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font> <font color="4444FF">&gt;</font><font color="4444FF">&gt;</font> <font color="#FF0000">3</font><font color="4444FF">)</font> <font color="4444FF">&amp;</font> <font color="#FF0000">0x3F</font><font color="4444FF">;</font>
<a name="line240" href="#line240">240</a> 
<a name="line241" href="#line241">241</a>         <font color="#444444">/* Set the first char of padding to 0x80.  This is safe since there is
<a name="line242" href="#line242">242</a>            always at least one byte free */</font>
<a name="line243" href="#line243">243</a>         <font color="#2040a0">p</font> <font color="4444FF">=</font> <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font> <font color="4444FF">+</font> <font color="#2040a0">count</font><font color="4444FF">;</font>
<a name="line244" href="#line244">244</a>         <font color="4444FF">*</font><font color="#2040a0">p</font><font color="4444FF">+</font><font color="4444FF">+</font> <font color="4444FF">=</font> <font color="#FF0000">0x80</font><font color="4444FF">;</font>
<a name="line245" href="#line245">245</a> 
<a name="line246" href="#line246">246</a>         <font color="#444444">/* Bytes of padding needed to make 64 bytes */</font>
<a name="line247" href="#line247">247</a>         <font color="#2040a0">count</font> <font color="4444FF">=</font> <font color="#FF0000">64</font> <font color="4444FF">-</font> <font color="#FF0000">1</font> <font color="4444FF">-</font> <font color="#2040a0">count</font><font color="4444FF">;</font>
<a name="line248" href="#line248">248</a> 
<a name="line249" href="#line249">249</a>         <font color="#444444">/* Pad out to 56 mod 64 */</font>
<a name="line250" href="#line250">250</a>         <strong>if</strong> <font color="4444FF">(</font><font color="#2040a0">count</font> <font color="4444FF">&lt;</font> <font color="#FF0000">8</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>
<a name="line251" href="#line251">251</a>                 <font color="#444444">/* Two lots of padding:  Pad the first block to 64 bytes */</font>
<a name="line252" href="#line252">252</a>                 <font color="#2040a0">memset</font><font color="4444FF">(</font><font color="#2040a0">p</font>, <font color="#FF0000">0</font>, <font color="#2040a0">count</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line253" href="#line253">253</a>                 <font color="#2040a0">byteReverse</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font>, <font color="#FF0000">16</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line254" href="#line254">254</a>                 <font color="#2040a0">MD5Transform</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font>, <font color="4444FF">(</font><font color="#2040a0">uint32</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line255" href="#line255">255</a> 
<a name="line256" href="#line256">256</a>                 <font color="#444444">/* Now fill the next block with 56 bytes */</font>
<a name="line257" href="#line257">257</a>                 <font color="#2040a0">memset</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font>, <font color="#FF0000">0</font>, <font color="#FF0000">56</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line258" href="#line258">258</a>         <font color="4444FF"><strong>}</strong></font> <strong>else</strong> <font color="4444FF"><strong>{</strong></font>
<a name="line259" href="#line259">259</a>                 <font color="#444444">/* Pad block to 56 bytes */</font>
<a name="line260" href="#line260">260</a>                 <font color="#2040a0">memset</font><font color="4444FF">(</font><font color="#2040a0">p</font>, <font color="#FF0000">0</font>, <font color="#2040a0">count</font><font color="4444FF">-</font><font color="#FF0000">8</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line261" href="#line261">261</a>         <font color="4444FF"><strong>}</strong></font>
<a name="line262" href="#line262">262</a>         <font color="#2040a0">byteReverse</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font>, <font color="#FF0000">14</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line263" href="#line263">263</a> 
<a name="line264" href="#line264">264</a>         <font color="#444444">/* Append length in bits and transform */</font>
<a name="line265" href="#line265">265</a>         <font color="4444FF">(</font><font color="4444FF">(</font><font color="#2040a0">uint32</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font><font color="4444FF">)</font><font color="4444FF">[</font> <font color="#FF0000">14</font> <font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">0</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line266" href="#line266">266</a>         <font color="4444FF">(</font><font color="4444FF">(</font><font color="#2040a0">uint32</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font><font color="4444FF">)</font><font color="4444FF">[</font> <font color="#FF0000">15</font> <font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">bits</font><font color="4444FF">[</font><font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line267" href="#line267">267</a> 
<a name="line268" href="#line268">268</a>         <font color="#2040a0">MD5Transform</font><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font>, <font color="4444FF">(</font><font color="#2040a0">uint32</font> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">in</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line269" href="#line269">269</a>         <font color="#2040a0">byteReverse</font><font color="4444FF">(</font><font color="4444FF">(</font><strong>unsigned</strong> <strong>char</strong> <font color="4444FF">*</font><font color="4444FF">)</font><font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font>, <font color="#FF0000">4</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line270" href="#line270">270</a>         <font color="#2040a0">memcpy</font><font color="4444FF">(</font><font color="#2040a0">digest</font>, <font color="#2040a0">ctx</font><font color="4444FF">-</font><font color="4444FF">&gt;</font><font color="#2040a0">buf</font>, <font color="#FF0000">16</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line271" href="#line271">271</a>         <font color="#2040a0">memset</font><font color="4444FF">(</font><font color="#2040a0">ctx</font>, <font color="#FF0000">0</font>, <strong>sizeof</strong><font color="4444FF">(</font><font color="#2040a0">ctx</font><font color="4444FF">)</font><font color="4444FF">)</font><font color="4444FF">;</font>    <font color="#444444">/* In case it's sensitive */</font>
<a name="line272" href="#line272">272</a> <font color="4444FF"><strong>}</strong></font>
<a name="line273" href="#line273">273</a> 
<a name="line274" href="#line274">274</a> <font color="#444444">/*
<a name="line275" href="#line275">275</a> ** Convert a digest into base-16.  digest should be declared as
<a name="line276" href="#line276">276</a> ** &quot;unsigned char digest[16]&quot; in the calling function.  The MD5
<a name="line277" href="#line277">277</a> ** digest is stored in the first 16 bytes.  zBuf should
<a name="line278" href="#line278">278</a> ** be &quot;char zBuf[33]&quot;.
<a name="line279" href="#line279">279</a> */</font>
<a name="line280" href="#line280">280</a> <strong>static</strong> <strong>void</strong> <font color="#2040a0">DigestToBase16</font><font color="4444FF">(</font><strong>unsigned</strong> <strong>char</strong> <font color="4444FF">*</font><font color="#2040a0">digest</font>, <strong>char</strong> <font color="4444FF">*</font><font color="#2040a0">zBuf</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
<a name="line281" href="#line281">281</a>   <strong>static</strong> <strong>char</strong> <strong>const</strong> <font color="#2040a0">zEncode</font><font color="4444FF">[</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#008000">&quot;0123456789abcdef&quot;</font><font color="4444FF">;</font>
<a name="line282" href="#line282">282</a>   <strong>int</strong> <font color="#2040a0">i</font>, <font color="#2040a0">j</font><font color="4444FF">;</font>
<a name="line283" href="#line283">283</a> 
<a name="line284" href="#line284">284</a>   <strong>for</strong><font color="4444FF">(</font><font color="#2040a0">j</font><font color="4444FF">=</font><font color="#2040a0">i</font><font color="4444FF">=</font><font color="#FF0000">0</font><font color="4444FF">;</font> <font color="#2040a0">i</font><font color="4444FF">&lt;</font><font color="#FF0000">16</font><font color="4444FF">;</font> <font color="#2040a0">i</font><font color="4444FF">+</font><font color="4444FF">+</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
<a name="line285" href="#line285">285</a>     <strong>int</strong> <font color="#2040a0">a</font> <font color="4444FF">=</font> <font color="#2040a0">digest</font><font color="4444FF">[</font><font color="#2040a0">i</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line286" href="#line286">286</a>     <font color="#2040a0">zBuf</font><font color="4444FF">[</font><font color="#2040a0">j</font><font color="4444FF">+</font><font color="4444FF">+</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#2040a0">zEncode</font><font color="4444FF">[</font><font color="4444FF">(</font><font color="#2040a0">a</font><font color="4444FF">&gt;</font><font color="4444FF">&gt;</font><font color="#FF0000">4</font><font color="4444FF">)</font><font color="4444FF">&amp;</font><font color="#FF0000">0xf</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line287" href="#line287">287</a>     <font color="#2040a0">zBuf</font><font color="4444FF">[</font><font color="#2040a0">j</font><font color="4444FF">+</font><font color="4444FF">+</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#2040a0">zEncode</font><font color="4444FF">[</font><font color="#2040a0">a</font> <font color="4444FF">&amp;</font> <font color="#FF0000">0xf</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line288" href="#line288">288</a>   <font color="4444FF"><strong>}</strong></font>
<a name="line289" href="#line289">289</a>   <font color="#2040a0">zBuf</font><font color="4444FF">[</font><font color="#2040a0">j</font><font color="4444FF">]</font> <font color="4444FF">=</font> <font color="#FF0000">0</font><font color="4444FF">;</font>
<a name="line290" href="#line290">290</a> <font color="4444FF"><strong>}</strong></font>
<a name="line291" href="#line291">291</a> 
<a name="line292" href="#line292">292</a> <strong>int</strong> <font color="#2040a0">main</font><font color="4444FF">(</font><strong>int</strong> <font color="#2040a0">argc</font>, <strong>char</strong> <font color="4444FF">*</font><font color="4444FF">*</font><font color="#2040a0">argv</font><font color="4444FF">)</font>
<a name="line293" href="#line293">293</a> <font color="4444FF"><strong>{</strong></font>
<a name="line294" href="#line294">294</a>         <strong>unsigned</strong> <strong>char</strong> <font color="#2040a0">buf</font><font color="4444FF">[</font><font color="#FF0000">16</font><font color="4444FF">]</font><font color="4444FF">;</font>
<a name="line295" href="#line295">295</a>         <font color="#2040a0">MD5Context</font> <font color="#2040a0">a</font><font color="4444FF">;</font>
<a name="line296" href="#line296">296</a> 
<a name="line297" href="#line297">297</a>         <strong>char</strong> <font color="4444FF">*</font><font color="#2040a0">x</font><font color="4444FF">;</font>
<a name="line298" href="#line298">298</a>         <font color="#2040a0">x</font> <font color="4444FF">=</font> <font color="#2040a0">getpass</font><font color="4444FF">(</font><font color="#008000">&quot;Password: &quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line299" href="#line299">299</a>         <font color="#2040a0">printf</font><font color="4444FF">(</font><font color="#008000">&quot;%c:%02x<font color="#77dd77">\n</font>&quot;</font>, <font color="#2040a0">x</font><font color="4444FF">[</font><font color="#2040a0">strlen</font><font color="4444FF">(</font><font color="#2040a0">x</font><font color="4444FF">)</font><font color="4444FF">-</font><font color="#FF0000">1</font><font color="4444FF">]</font>, <font color="#2040a0">x</font><font color="4444FF">[</font><font color="#2040a0">strlen</font><font color="4444FF">(</font><font color="#2040a0">x</font><font color="4444FF">)</font> <font color="4444FF">-</font><font color="#FF0000">1</font><font color="4444FF">]</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line300" href="#line300">300</a>         <font color="#2040a0">MD5Init</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">a</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line301" href="#line301">301</a>         <font color="#2040a0">MD5Update</font><font color="4444FF">(</font><font color="4444FF">&amp;</font><font color="#2040a0">a</font>, <font color="#2040a0">x</font>, <font color="#2040a0">strlen</font><font color="4444FF">(</font><font color="#2040a0">x</font><font color="4444FF">)</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line302" href="#line302">302</a>         <font color="#2040a0">MD5Final</font><font color="4444FF">(</font><font color="#2040a0">buf</font>, <font color="4444FF">&amp;</font><font color="#2040a0">a</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line303" href="#line303">303</a> 
<a name="line304" href="#line304">304</a>         <strong>if</strong><font color="4444FF">(</font><font color="#2040a0">memcmp</font><font color="4444FF">(</font><font color="#2040a0">buf</font>, <font color="#008000">&quot;<font color="#77dd77">\x</font>15<font color="#77dd77">\x</font>5f<font color="#77dd77">\x</font>b9<font color="#77dd77">\x</font>5d<font color="#77dd77">\x</font>04<font color="#77dd77">\x</font>28<font color="#77dd77">\x</font>7b<font color="#77dd77">\x</font>75<font color="#77dd77">\x</font>7c<font color="#77dd77">\x</font>99<font color="#77dd77">\x</font>6d<font color="#77dd77">\x</font>77<font color="#77dd77">\x</font>b5<font color="#77dd77">\x</font>ea<font color="#77dd77">\x</font>51<font color="#77dd77">\x</font>f7&quot;</font>, <font color="#FF0000">16</font><font color="4444FF">)</font> <font color="4444FF">=</font><font color="4444FF">=</font> <font color="#FF0000">0</font><font color="4444FF">)</font><font color="4444FF"><strong>{</strong></font>
<a name="line305" href="#line305">305</a>                 <font color="#2040a0">printf</font><font color="4444FF">(</font><font color="#008000">&quot;You got the right password, congrats!<font color="#77dd77">\n</font>&quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line306" href="#line306">306</a>                 <font color="#2040a0">setresgid</font><font color="4444FF">(</font><font color="#2040a0">getegid</font><font color="4444FF">(</font><font color="4444FF">)</font>, <font color="#2040a0">getegid</font><font color="4444FF">(</font><font color="4444FF">)</font>, <font color="#2040a0">getegid</font><font color="4444FF">(</font><font color="4444FF">)</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line307" href="#line307">307</a>                 <font color="#2040a0">setresuid</font><font color="4444FF">(</font><font color="#2040a0">geteuid</font><font color="4444FF">(</font><font color="4444FF">)</font>, <font color="#2040a0">geteuid</font><font color="4444FF">(</font><font color="4444FF">)</font>, <font color="#2040a0">geteuid</font><font color="4444FF">(</font><font color="4444FF">)</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line308" href="#line308">308</a>                 <font color="#2040a0">system</font><font color="4444FF">(</font><font color="#008000">&quot;/bin/sh&quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line309" href="#line309">309</a>         <font color="4444FF"><strong>}</strong></font> <strong>else</strong> <font color="4444FF"><strong>{</strong></font>
<a name="line310" href="#line310">310</a>                 <font color="#2040a0">usleep</font><font color="4444FF">(</font><font color="#FF0000">500</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line311" href="#line311">311</a>                 <font color="#2040a0">printf</font><font color="4444FF">(</font><font color="#008000">&quot;Incorrect password<font color="#77dd77">\n</font>&quot;</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line312" href="#line312">312</a>         <font color="4444FF"><strong>}</strong></font>
<a name="line313" href="#line313">313</a>         <font color="#2040a0">exit</font><font color="4444FF">(</font><font color="#FF0000">0</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line314" href="#line314">314</a> <font color="4444FF"><strong>}</strong></font>
