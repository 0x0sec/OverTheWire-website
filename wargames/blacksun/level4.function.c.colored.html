<a name="line1" href="#line1"> 1</a> <font color="#2040a0">PHP_FUNCTION</font><font color="4444FF">(</font><font color="#2040a0">dovuln</font><font color="4444FF">)</font>
<a name="line2" href="#line2"> 2</a> <font color="4444FF"><strong>{</strong></font>
<a name="line3" href="#line3"> 3</a>         <font color="#2040a0">zval</font> <font color="4444FF">*</font><font color="4444FF">*</font><font color="#2040a0">p_str</font>, <font color="4444FF">*</font><font color="4444FF">*</font><font color="#2040a0">p_len</font><font color="4444FF">;</font>
<a name="line4" href="#line4"> 4</a>         <strong>char</strong> <font color="4444FF">*</font><font color="#2040a0">str</font>, <font color="4444FF">*</font><font color="#2040a0">smashme</font><font color="4444FF">;</font>
<a name="line5" href="#line5"> 5</a>         <strong>int</strong> <font color="#2040a0">argc</font> <font color="4444FF">=</font> <font color="#2040a0">ZEND_NUM_ARGS</font><font color="4444FF">(</font><font color="4444FF">)</font>, <font color="#2040a0">len</font> <font color="4444FF">=</font> <font color="#FF0000">42</font>, <font color="#2040a0">strlen</font><font color="4444FF">;</font>
<a name="line6" href="#line6"> 6</a>         
<a name="line7" href="#line7"> 7</a>         <strong>if</strong> <font color="4444FF">(</font><font color="#2040a0">argc</font> <font color="4444FF">&lt;</font> <font color="#FF0000">2</font> <font color="4444FF">|</font><font color="4444FF">|</font> <font color="#2040a0">argc</font> <font color="4444FF">&gt;</font> <font color="#FF0000">3</font> <font color="4444FF">|</font><font color="4444FF">|</font> <font color="#2040a0">zend_get_parameters_ex</font><font color="4444FF">(</font><font color="#2040a0">argc</font>, <font color="4444FF">&amp;</font><font color="#2040a0">p_str</font>, <font color="4444FF">&amp;</font><font color="#2040a0">p_len</font><font color="4444FF">)</font> <font color="4444FF">=</font><font color="4444FF">=</font> <font color="#2040a0">FAILURE</font><font color="4444FF">)</font> <font color="4444FF"><strong>{</strong></font>
<a name="line8" href="#line8"> 8</a>              <font color="#2040a0">WRONG_PARAM_COUNT</font><font color="4444FF">;</font>
<a name="line9" href="#line9"> 9</a>         <font color="4444FF"><strong>}</strong></font>
<a name="line10" href="#line10">10</a> 
<a name="line11" href="#line11">11</a>         <font color="#2040a0">convert_to_string_ex</font><font color="4444FF">(</font><font color="#2040a0">p_str</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line12" href="#line12">12</a>         <font color="#2040a0">convert_to_long_ex</font><font color="4444FF">(</font><font color="#2040a0">p_len</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line13" href="#line13">13</a>         <font color="#2040a0">len</font> <font color="4444FF">=</font> <font color="#2040a0">Z_LVAL_PP</font><font color="4444FF">(</font><font color="#2040a0">p_len</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line14" href="#line14">14</a>         <font color="#2040a0">str</font> <font color="4444FF">=</font> <font color="#2040a0">Z_STRVAL_PP</font><font color="4444FF">(</font><font color="#2040a0">p_str</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line15" href="#line15">15</a>         <font color="#2040a0">strlen</font> <font color="4444FF">=</font> <font color="#2040a0">Z_STRLEN_PP</font><font color="4444FF">(</font><font color="#2040a0">p_str</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line16" href="#line16">16</a>         <font color="#2040a0">smashme</font> <font color="4444FF">=</font> <font color="#2040a0">emalloc</font><font color="4444FF">(</font><font color="#2040a0">len</font><font color="4444FF">)</font><font color="4444FF">;</font>
<a name="line17" href="#line17">17</a>         <font color="#2040a0">memcpy</font><font color="4444FF">(</font><font color="#2040a0">smashme</font>, <font color="#2040a0">str</font>, <font color="#2040a0">strlen</font><font color="4444FF">)</font><font color="4444FF">;</font> //<font color="#2040a0">xxx</font>
<a name="line18" href="#line18">18</a> <font color="4444FF"><strong>}</strong></font>
